"""
The main classification model
"""

from torch import nn
from .decoder import BinaryClassificationDecoder


def create(d_size: int = 512) -> nn.Module:
    """
    Creates the unfit model.
    :return: Created model
    """
    decoder = BinaryClassificationDecoder(d_size)
    model = nn.Transformer(
        d_model=d_size,          # default: 512
        nhead=8,                 # default: 8
        num_encoder_layers=3,    # default: 6
        num_decoder_layers=3,    # default: 6
        dim_feedforward=128,     # default: 2048
        dropout=0.1,             # default: 0.1
        activation="relu",       # default: "relu"
        custom_encoder=None,     # default: None
        custom_decoder=decoder,  # default: None
        layer_norm_eps=1e-05,    # default: 1e-05
        batch_first=True,        # default: False
        norm_first=False,        # default: False
        bias=True,               # default: True
        device=None,             # default: None
        dtype=None               # default: None
    )
    return model
